---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - pnpm-lock.yaml
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "pnpm install completes without errors"
    - "package.json exists with type: module and all required scripts"
    - "pnpm-lock.yaml exists (lockfile generated)"
  artifacts:
    - path: "package.json"
      provides: "Project manifest with scripts and dependencies"
      contains: "type.*module"
    - path: "pnpm-lock.yaml"
      provides: "Dependency lockfile"
      min_lines: 10
    - path: ".gitignore"
      provides: "Git ignore patterns for Node.js project"
      contains: "node_modules"
  key_links:
    - from: "package.json"
      to: "node_modules"
      via: "pnpm install"
      pattern: "devDependencies"
---

<objective>
Initialize the pnpm project with package.json, install dev dependencies, and configure .gitignore.

Purpose: Establish the foundation for all other tooling (TypeScript, Biome, Vitest require deps installed first).
Output: Working pnpm project with all dev dependencies installed.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize pnpm and install dependencies</name>
  <files>package.json, pnpm-lock.yaml</files>
  <action>
    1. Initialize pnpm project: `pnpm init`
    2. Edit package.json to set:
       - name: "kata-context"
       - version: "0.1.0"
       - type: "module" (CRITICAL for ESM/NodeNext)
       - engines: { "node": ">=24.0.0" }
       - scripts:
         - "dev": "tsc --watch"
         - "build": "tsc"
         - "test": "vitest run"
         - "test:watch": "vitest"
         - "lint": "biome lint ."
         - "format": "biome format --write ."
         - "check": "biome check --write ."
    3. Install dev dependencies with exact versions:
       `pnpm add -D --save-exact typescript@5.9.3 @types/node@24.0.0 vitest@4.0.17 @biomejs/biome@2.3.11`

    IMPORTANT: Use --save-exact to pin versions for reproducible builds.
    IMPORTANT: Must include "type": "module" - NodeNext requires ESM.
  </action>
  <verify>
    - `cat package.json | grep '"type": "module"'` returns match
    - `cat package.json | grep '"lint"'` returns match
    - `ls pnpm-lock.yaml` exists
    - `pnpm install` completes without errors
  </verify>
  <done>
    - package.json has type: "module", all 7 scripts, and 4 devDependencies
    - pnpm-lock.yaml generated
    - node_modules populated
  </done>
</task>

<task type="auto">
  <name>Task 2: Update .gitignore for Node.js project</name>
  <files>.gitignore</files>
  <action>
    Update .gitignore to include standard Node.js patterns:

    ```
    # Dependencies
    node_modules/

    # Build output
    dist/

    # IDE
    .idea/
    *.swp
    *.swo

    # OS
    .DS_Store
    Thumbs.db

    # Test coverage
    coverage/

    # Environment
    .env
    .env.local
    .env.*.local

    # Vercel
    .vercel
    ```

    Preserve any existing entries (the file currently has ".secrets" on one line).
  </action>
  <verify>`grep "node_modules" .gitignore` returns match</verify>
  <done>.gitignore includes node_modules, dist, coverage, and .env patterns</done>
</task>

</tasks>

<verification>
Run these commands to verify phase completion:

```bash
# Check package.json structure
cat package.json | grep -E '"type"|"scripts"|"devDependencies"'

# Verify lockfile exists
ls -la pnpm-lock.yaml

# Verify deps are installed
ls node_modules/.bin/tsc node_modules/.bin/vitest node_modules/.bin/biome

# Verify gitignore
grep "node_modules" .gitignore
```
</verification>

<success_criteria>
1. `pnpm install` runs without errors
2. package.json has type: "module"
3. package.json has all 7 required scripts (dev, build, test, test:watch, lint, format, check)
4. All 4 dev dependencies installed (typescript, @types/node, vitest, @biomejs/biome)
5. pnpm-lock.yaml exists
6. .gitignore includes node_modules and dist
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
